{embed="includes/header"}
<form action="#" id="book_a_room">
	<div id="form_box_2">
		<div class="row">
			<div id="title_reservation" class="row">
					<div class="large-4 columns">
						<h2>NEW RESERVATION</h2>
					</div>
					<div class="large-4 large-offset-4 columns">
						<p>Phone reservations +511-440-6040</p>
						{exp:get_post_vars parse="inward"}
							<p>FECHA CHECKIN: {post_check_in_date} </p>
							<p>FECHA CHECKOUT: {post_check_out_date}</p>
							<p>ROOM: {post_room_number}</p>
						{/exp:get_post_vars}
					</div>
			</div>

		</div>
		<div class="row">
			<div id="sub_title_reservation" class="row">
				<div class="large-6 columns "> 
					<b><h3>Room 1 of 2</h3></b>
					<b><p>Select from availability below</p></b>
				</div>
			</div>
			<div class="row">
				<div class="large-5 columns">
					<h4>Room Type</h4>
				</div>
				<div class="large-7 columns">
					<h4>Average Rate per Night</h4>
				</div>
			</div>
			{exp:get_post_vars parse="inward"}
				{exp:infhotel:disponibilidadinicialhabitaciones3
					fecha_checkin = "{post_check_in_date}"
					fecha_checkout = "{post_check_out_date}"
					rooms_num =  "{post_room_number}" 
				}
				{/exp:infhotel:disponibilidadinicialhabitaciones3}
			{/exp:get_post_vars}
		</div>
	</div>
</form>
{embed="includes/footer"}
	{exp:get_post_vars parse="inward"}
<script>
	$(function() {
		num_hab = {post_room_number};
		hide_divs(num_hab,0);
      });

	$(function() {
		var num_hab = {post_room_number};
		var checkin_date ="";
		var checkout_date ="";
		var checkin = ""+{post_check_in_date} ;
		var checkout = ""+{post_check_out_date} ;
		var simple = 0;
		var doble = 0;
		var triple = 0;
		var suite = 0;

		checkin_date = checkin.substr(4, 4)+"-"+checkin.substr(2, 2)+"-"+checkin.substr(0, 2)+" 12:00:00.000";
		checkout_date = checkout.substr(4, 4)+"-"+checkout.substr(2, 2)+"-"+checkout.substr(0, 2)+" 12:00:00.000";
		var data = {
			 	"FLlegada": checkin_date,
			    "FSalida": checkout_date,
			    "HLlegada": checkin_date,
			    "HSalida": checkout_date,
			    "Habitaciones": {},
			    "MObservacion": "",				
                "NPasajero": "",
                "Pasajeros" : {}
		};
		
		reservar_hab(num_hab, '#add_room_simple0', 1, simple);
		reservar_hab(num_hab, '#add_room_doble0', 1, doble);
		reservar_hab(num_hab, '#add_room_triple0', 1, triple);
		reservar_hab(num_hab, '#add_room_suite0', 1, suite);
		
		reservar_hab(num_hab, '#add_room_simple1', 2, simple);
		reservar_hab(num_hab, '#add_room_doble1', 2, doble);
		reservar_hab(num_hab, '#add_room_triple1', 2, triple);
		reservar_hab(num_hab, '#add_room_suite1', 2, suite);

		reservar_hab(num_hab, '#add_room_simple2', 3, simple);
		reservar_hab(num_hab, '#add_room_doble2', 3, doble);
		reservar_hab(num_hab, '#add_room_triple2', 3, triple);
		reservar_hab(num_hab, '#add_room_suite2', 3, suite);

		$('#add_room_simple').click(function(){
			 simple = simple + 1 ;
		});
		$('#add_room_double').click(function(){
			 doble = doble + 1 ;	
		});
		$('#add_room_triple').click(function(){
			 triple = triple + 1 ;	
		});
		$('#add_room_suite').click(function(){
			 suite = suite + 1 ;
		});

		var habitacion = {
			"CantHab" : "1" ,
			"NPrecio" : "150" ,
			"TCodigoHabitacion" : "120"
		}
		var persona = {
			"TDocumento": "12345678",
            "TMaterno" : "pasajero01",  
            "TNacionalidad" : "069",      
            "TNombre" : "pasajero01",
            "TPaterno" : "pasajero01",  
            "TTarjeta" : "1234567890",
            "TTipoDocumento" : "02",
            "TTipoTarjeta" : "04" 
		} 
		data["Habitaciones"]["0"]=habitacion;
		data["Habitaciones"]["1"]=habitacion;
		data["Habitaciones"]["2"]=habitacion;
		data["Pasajeros"]["0"]=persona;

		var send = JSON.stringify(data);
		console.log(send);

      });

	function hide_divs (rooms_num, div_visible){
		for(i=0;i<rooms_num;i++){
			if(i!=div_visible) {
				$("#rooms"+i).hide();
			}
		}
	}

	function reservar_hab (rooms_num, buttom, next_div, num_hab_reserv){
		$(buttom).click(function(){
			num_hab_reserv = num_hab_reserv + 1 ;
			hide_divs(rooms_num, next_div);
		});
	}
</script>
{/exp:get_post_vars}