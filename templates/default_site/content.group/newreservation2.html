{embed="includes/header"}
<form action="#" id="book_a_room">
	<div id="form_box_2">
		<div class="row">
			<div id="title_reservation" class="row">
					<div class="large-4 columns">
						<h2>NEW RESERVATION</h2>
					</div>
					<div class="large-4 large-offset-4 columns">
						<p>Phone reservations +511-440-6040</p>
						{exp:get_post_vars parse="inward"}
							<p>FECHA CHECKIN: {post_check_in_date} </p>
							<p>FECHA CHECKOUT: {post_check_out_date}</p>
							<p>ROOM: {post_room_number}</p>
						{/exp:get_post_vars}
					</div>
			</div>

		</div>
		<div class="row">
			<div id="sub_title_reservation" class="row">
				<div class="large-6 columns "> 
					{exp:get_post_vars parse="inward"}
					<b><h3 id="step_in_reservation">Room 1 of {post_room_number}</h3></b>
					{/exp:get_post_vars}
					<b><p>Select from availability below</p></b>
				</div>
			</div>
			<div class="row">
				<div class="large-5 columns">
					<h4>Room Type</h4>
				</div>
				<div class="large-7 columns">
					<h4>Average Rate per Night</h4>
				</div>
			</div>
			{exp:get_post_vars parse="inward"}
				{exp:infhotel:disponibilidadinicialhabitaciones3
					fecha_checkin = "{post_check_in_date}"
					fecha_checkout = "{post_check_out_date}"
					rooms_num =  "{post_room_number}" 
				}
				{/exp:infhotel:disponibilidadinicialhabitaciones3}
			{/exp:get_post_vars}
		</div>
	</div>
</form>
{embed="includes/footer"}
	{exp:get_post_vars parse="inward"}
<script>
	$(function() {
		num_hab = {post_room_number};
		hide_divs(num_hab,0);
      });

	$(function() {
		var num_hab = {post_room_number};
		var checkin_date ="";
		var checkout_date ="";
		var checkin = ""+{post_check_in_date} ;
		var checkout = ""+{post_check_out_date} ;
		var simple = 0;
		var doble = 0;
		var triple = 0;
		var suite = 0;

		checkin_date = checkin.substr(4, 4)+"-"+checkin.substr(2, 2)+"-"+checkin.substr(0, 2)+" 12:00:00.000";
		checkout_date = checkout.substr(4, 4)+"-"+checkout.substr(2, 2)+"-"+checkout.substr(0, 2)+" 12:00:00.000";
		var data = {
			 	"FLlegada": checkin_date,
			    "FSalida": checkout_date,
			    "HLlegada": checkin_date,
			    "HSalida": checkout_date,
			    "Habitaciones": {},
			    "MObservacion": "",				
                "NPasajero": "",
                "Pasajeros" : {}
		};
		
		reservar_hab(num_hab, '#add_room_simple0', 1, 1);
		reservar_hab(num_hab, '#add_room_doble0', 1, 2);
		reservar_hab(num_hab, '#add_room_triple0', 1, 3);
		reservar_hab(num_hab, '#add_room_suite0', 1, 4);

		reservar_hab(num_hab, '#add_room_simple1', 2, 1);
		reservar_hab(num_hab, '#add_room_doble1', 2, 2);
		reservar_hab(num_hab, '#add_room_triple1', 2, 3);
		reservar_hab(num_hab, '#add_room_suite1', 2, 4);

		reservar_hab(num_hab, '#add_room_simple2', 3, 1);
		reservar_hab(num_hab, '#add_room_doble2', 3, 2);
		reservar_hab(num_hab, '#add_room_triple2', 3, 3);
		reservar_hab(num_hab, '#add_room_suite2', 3, 4);

		reservar_hab(num_hab, '#add_room_simple3', 4, 1);
		reservar_hab(num_hab, '#add_room_doble3', 4, 2);
		reservar_hab(num_hab, '#add_room_triple3', 4, 3);
		reservar_hab(num_hab, '#add_room_suite3', 4, 4);

		var habitacion = {
			"CantHab" : "1" ,
			"NPrecio" : "150" ,
			"TCodigoHabitacion" : "120"
		}
		var persona = {
			"TDocumento": "12345678",
            "TMaterno" : "pasajero01",  
            "TNacionalidad" : "069",      
            "TNombre" : "pasajero01",
            "TPaterno" : "pasajero01",  
            "TTarjeta" : "1234567890",
            "TTipoDocumento" : "02",
            "TTipoTarjeta" : "04" 
		} 
		data["Habitaciones"]["0"]=habitacion;
		data["Habitaciones"]["1"]=habitacion;
		data["Habitaciones"]["2"]=habitacion;
		data["Pasajeros"]["0"]=persona;

		var send = JSON.stringify(data);
		console.log(send);

		
	function reservar_hab (rooms_num, buttom, next_div, type_hab){
			switch(type_hab){
				case 1:
				    $(buttom).click(function(){
				    	simple = simple + 1;
				    	hide_divs(rooms_num, next_div);
				    	console.log(buttom+":"+simple);
				    });
				    break;
				case 2:
				    $(buttom).click(function(){
				    	doble = doble + 1;
				    	hide_divs(rooms_num, next_div);
				    	console.log(buttom+":"+doble);
				    });
				    break;
				case 3:
				    $(buttom).click(function(){
				    	triple = triple + 1;
				    	hide_divs(rooms_num, next_div);
				    	console.log(buttom+":"+triple);
				    });
				    break;
				case 4:
				    $(buttom).click(function(){
				    	suite = suite + 1;
				    	hide_divs(rooms_num, next_div);
				    	//window.location.replace("http://chicamasurf.com/content/newreservation3");
				    	console.log(buttom+":"+suite);
				    });
				    break;
			}
		}
      });

function hide_divs (rooms_num, div_visible){
		for(i=0;i<rooms_num;i++){
			if(i==div_visible) {
				$("#rooms"+i).show();
			}
			else{
				$("#rooms"+i).hide();
			}
		}
		switch(div_visible){
			case 0:
				if(0<rooms_num){
			    	$("#step_in_reservation").html("Room 1 of "+num_hab);
			    }
			    else{
			    	window.location.replace("http://chicamasurf.com/content/newreservation3");
			    }
			    break;
			case 1:
				if(1<rooms_num){
			    	$("#step_in_reservation").html("Room 2 of "+num_hab);
			    }
			    else{
			    	window.location.replace("http://chicamasurf.com/content/newreservation3");
			    }
			    break;
			case 2:
			    if(2<rooms_num){
			    	$("#step_in_reservation").html("Room 3 of "+num_hab);
			    }
			    else{
			    	window.location.replace("http://chicamasurf.com/content/newreservation3");
			    }
			    break;
			case 3:
			    if(3<rooms_num){
			    	$("#step_in_reservation").html("Room 4 of "+num_hab);
			    }
			    else{
			    	window.location.replace("http://chicamasurf.com/content/newreservation3");
			    }
			    break;   
		}
	}
</script>
{/exp:get_post_vars}